/*! For license information please see 47025c42fb09f010148b.js.LICENSE.txt */
function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,n,o,a){var s=n&&n.prototype instanceof i?n:i,u=Object.create(s.prototype);return _regeneratorDefine2(u,"_invoke",function(r,n,o){var a,i,s,u=0,f=o||[],p=!1,l={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return a=t,i=0,s=e,l.n=r,c}};function d(r,n){for(i=r,s=n,t=0;!p&&u&&!o&&t<f.length;t++){var o,a=f[t],d=l.p,y=a[2];r>3?(o=y===n)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=r<2&&d<a[1])?(i=0,l.v=n,l.n=a[1]):d<y&&(o=r<3||a[0]>n||n>y)&&(a[4]=r,a[5]=n,l.n=y,i=0))}if(o||r>1)return c;throw p=!0,n}return function(o,f,y){if(u>1)throw TypeError("Generator is already running");for(p&&1===f&&d(f,y),i=f,s=y;(t=i<2?e:s)||!p;){a||(i?i<3?(i>1&&(l.n=-1),d(i,s)):l.n=s:l.v=s);try{if(u=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(p=l.n<0)?s:r.call(n,l))!==c)break}catch(t){a=e,i=1,s=t}finally{u=1}}return{value:t,done:p}}}(r,o,a),!0),u}var c={};function i(){}function s(){}function u(){}t=Object.getPrototypeOf;var f=[][n]?t(t([][n]())):(_regeneratorDefine2(t={},n,function(){return this}),t),p=u.prototype=i.prototype=Object.create(f);function l(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_regeneratorDefine2(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=u,_regeneratorDefine2(p,"constructor",u),_regeneratorDefine2(u,"constructor",s),s.displayName="GeneratorFunction",_regeneratorDefine2(u,o,"GeneratorFunction"),_regeneratorDefine2(p),_regeneratorDefine2(p,o,"Generator"),_regeneratorDefine2(p,n,function(){return this}),_regeneratorDefine2(p,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:a,m:l}})()}function _regeneratorDefine2(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_regeneratorDefine2=function(e,t,r,n){if(t)o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{var a=function(t,r){_regeneratorDefine2(e,t,function(e){return this._invoke(t,r,e)})};a("next",0),a("throw",1),a("return",2)}},_regeneratorDefine2(e,t,r,n)}function asyncGeneratorStep(e,t,r,n,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function c(e){asyncGeneratorStep(a,n,o,c,i,"next",e)}function i(e){asyncGeneratorStep(a,n,o,c,i,"throw",e)}c(void 0)})}}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}import{createClient}from"@supabase/supabase-js";console.log("supabase global is:",_typeof(supabase));var supabaseUrl="https://qeejdhyyztuubxmdxnfk.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFlZWpkaHl5enR1dWJ4bWR4bmZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NDkzMjEsImV4cCI6MjA2NjMyNTMyMX0.3lqiF3ukDiFl67wPbRaSZR88k0yG2X1lue5g_pCiTzQ",supabase=supabase.createClient(supabaseUrl,supabaseKey);function fetchAndInsertData(){return _fetchAndInsertData.apply(this,arguments)}function _fetchAndInsertData(){return _fetchAndInsertData=_asyncToGenerator(_regenerator().m(function e(){var t,r,n,o,a;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if((t=document.getElementById("status")).textContent="",r=document.getElementById("projectIdInput").value.trim()){e.n=1;break}return t.textContent="Please enter a Project ID.",e.a(2);case 1:return e.p=1,e.n=2,supabase.from("projects").select("*").eq("id",r).single();case 2:if(n=e.v,o=n.data,!n.error&&o){e.n=3;break}throw new Error("No project found or fetch error");case 3:return e.n=4,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return(r=t.document.contentControls).load("items/tag"),e.n=1,t.sync();case 1:return r.items.forEach(function(e){"projectName"===e.tag?e.insertText(o.projectName||"",Word.InsertLocation.replace):"clientName"===e.tag?e.insertText(o.clientName||"",Word.InsertLocation.replace):"projectAddress"===e.tag?e.insertText(o.projectAddress||"",Word.InsertLocation.replace):"clientAddress"===e.tag?e.insertText(o.clientAddress||"",Word.InsertLocation.replace):"deadline"===e.tag?e.insertText(o.deadline||"",Word.InsertLocation.replace):"projectId"===e.tag&&e.insertText(o.id||"",Word.InsertLocation.replace)}),e.n=2,t.sync();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:t.textContent="Project data loaded successfully!",t.style.color="green",e.n=6;break;case 5:return e.p=5,a=e.v,console.error("Supabase fetch failed:",a),t.textContent="Failed to fetch project data from Supabase.",t.style.color="red",e.n=6,Word.run(function(){var e=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return t.document.body.insertText("Failed to fetch project data from Supabase.",Word.InsertLocation.end),e.n=1,t.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 6:return e.a(2)}},e,null,[[1,5]])})),_fetchAndInsertData.apply(this,arguments)}Office.onReady(function(){document.getElementById("fetchUserBtn").addEventListener("click",fetchAndInsertData)});